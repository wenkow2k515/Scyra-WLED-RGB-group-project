{% extends "body.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/mood.css') }}">
{% endblock %}

{% block content %}
<!-- Use semantic main tag for primary content -->
<main class="mood-container">
    <!-- ======== BACKGROUND ELEMENTS ======== -->
    <div class="led-bg" aria-hidden="true"></div>
    <div class="bg-gradient" aria-hidden="true"></div>

    <!-- ======== PAGE HEADER ======== -->
    <header class="page-header">
        <h1>Your Mood History</h1>
        <p class="subtitle">Track your emotional patterns over time</p>
    </header>
    
    <!-- ======== HISTORY CONTENT ======== -->
    <div class="history-container">
        {% if mood_entries %}
            <!-- Trend Charts -->
            <section class="history-section trend-charts">
                <h2>Mood Trends</h2>
                <div class="chart-card">
                    <div class="chart-tabs">
                        <button class="chart-tab active" data-period="week">Last Week</button>
                        <button class="chart-tab" data-period="month">Last Month</button>
                        <button class="chart-tab" data-period="year">Last Year</button>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="moodTrendChart"></canvas>
                    </div>
                    
                    <div class="chart-legend">
                        <div class="legend-item">
                            <span class="color-dot" style="background-color: rgba(255, 99, 132, 0.8);"></span>
                            <span>Energy</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot" style="background-color: rgba(54, 162, 235, 0.8);"></span>
                            <span>Happiness</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot" style="background-color: rgba(255, 206, 86, 0.8);"></span>
                            <span>Anxiety</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot" style="background-color: rgba(75, 192, 192, 0.8);"></span>
                            <span>Stress</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot" style="background-color: rgba(153, 102, 255, 0.8);"></span>
                            <span>Focus</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot" style="background-color: rgba(255, 159, 64, 0.8);"></span>
                            <span>Irritability</span>
                        </div>
                        <div class="legend-item">
                            <span class="color-dot" style="background-color: rgba(46, 204, 113, 0.8);"></span>
                            <span>Calmness</span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Radar View Section -->
            <section class="history-section radar-view">
                <h2>Mood Patterns</h2>
                <div class="chart-card">
                    <div class="chart-container">
                        <canvas id="moodRadarChart"></canvas>
                    </div>
                    <p class="chart-description">This radar chart shows your overall mood patterns, helping you visualize your emotional balance across all dimensions.</p>
                </div>
            </section>
            
            <!-- Color Patterns -->
            <section class="history-section color-patterns">
                <h2>Your Color Patterns</h2>
                <div class="color-history-card">
                    <p class="section-intro">The colors you've used over time can reveal patterns in your emotional landscape. Here's how your color choices have evolved:</p>
                    
                    <div class="color-timeline">
                        {% for entry in mood_entries if entry.color_suggestion %}
                            <div class="color-point" style="background-color: #{{ entry.color_suggestion.primary_color }};" title="{{ entry.timestamp.strftime('%B %d, %Y') }}"></div>
                        {% endfor %}
                    </div>
                    
                    <div class="color-stats">
                        <h3>Your Top Colors</h3>
                        <div class="color-frequency">
                            <!-- This would be populated with actual data in a real implementation -->
                            <div class="color-item">
                                <div class="color-sample" style="background-color: #0066FF;"></div>
                                <div class="color-info">
                                    <span class="color-name">Calming Blue</span>
                                    <span class="color-percentage">35%</span>
                                </div>
                            </div>
                            <div class="color-item">
                                <div class="color-sample" style="background-color: #FFEB3B;"></div>
                                <div class="color-info">
                                    <span class="color-name">Happy Yellow</span>
                                    <span class="color-percentage">25%</span>
                                </div>
                            </div>
                            <div class="color-item">
                                <div class="color-sample" style="background-color: #4CAF50;"></div>
                                <div class="color-info">
                                    <span class="color-name">Focused Green</span>
                                    <span class="color-percentage">20%</span>
                                </div>
                            </div>
                            <div class="color-item">
                                <div class="color-sample" style="background-color: #9C27B0;"></div>
                                <div class="color-info">
                                    <span class="color-name">Creative Purple</span>
                                    <span class="color-percentage">15%</span>
                                </div>
                            </div>
                            <div class="color-item">
                                <div class="color-sample" style="background-color: #FF5500;"></div>
                                <div class="color-info">
                                    <span class="color-name">Energetic Orange</span>
                                    <span class="color-percentage">5%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Mood Log -->
            <section class="history-section mood-log">
                <h2>Mood Log</h2>
                <div class="mood-log-filters">
                    <input type="text" id="mood-search" placeholder="Search journal entries...">
                    <select id="mood-sort">
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                        <option value="highest-energy">Highest Energy</option>
                        <option value="lowest-energy">Lowest Energy</option>
                        <option value="happiest">Happiest</option>
                        <option value="least-happy">Least Happy</option>
                        <option value="most-focused">Most Focused</option>
                        <option value="calmest">Calmest</option>
                    </select>
                </div>
                
                <div class="mood-entries-list">
                    {% for entry in mood_entries %}
                    <div class="mood-entry-card">
                        <div class="entry-header">
                            <div class="entry-date">{{ entry.timestamp.strftime('%B %d, %Y') }}</div>
                            <div class="entry-time">{{ entry.timestamp.strftime('%I:%M %p') }}</div>
                        </div>
                        
                        <div class="entry-metrics">
                            <div class="mini-metric">
                                <span class="mini-label">Energy</span>
                                <div class="mini-bar">
                                    <div class="mini-fill" style="width: {{ entry.energy_level * 10 }}%"></div>
                                </div>
                                <span class="mini-value">{{ entry.energy_level }}/10</span>
                            </div>
                            
                            <div class="mini-metric">
                                <span class="mini-label">Happiness</span>
                                <div class="mini-bar">
                                    <div class="mini-fill" style="width: {{ entry.happiness * 10 }}%"></div>
                                </div>
                                <span class="mini-value">{{ entry.happiness }}/10</span>
                            </div>
                            
                            <div class="mini-metric">
                                <span class="mini-label">Anxiety</span>
                                <div class="mini-bar">
                                    <div class="mini-fill" style="width: {{ entry.anxiety * 10 }}%"></div>
                                </div>
                                <span class="mini-value">{{ entry.anxiety }}/10</span>
                            </div>
                            
                            <div class="mini-metric">
                                <span class="mini-label">Stress</span>
                                <div class="mini-bar">
                                    <div class="mini-fill" style="width: {{ entry.stress * 10 }}%"></div>
                                </div>
                                <span class="mini-value">{{ entry.stress }}/10</span>
                            </div>
                            
                            <!-- New metrics -->
                            <div class="mini-metric">
                                <span class="mini-label">Focus</span>
                                <div class="mini-bar">
                                    <div class="mini-fill" style="width: {{ entry.focus * 10 }}%"></div>
                                </div>
                                <span class="mini-value">{{ entry.focus }}/10</span>
                            </div>
                            
                            <div class="mini-metric">
                                <span class="mini-label">Irritability</span>
                                <div class="mini-bar">
                                    <div class="mini-fill" style="width: {{ entry.irritability * 10 }}%"></div>
                                </div>
                                <span class="mini-value">{{ entry.irritability }}/10</span>
                            </div>
                            
                            <div class="mini-metric">
                                <span class="mini-label">Calmness</span>
                                <div class="mini-bar">
                                    <div class="mini-fill" style="width: {{ entry.calmness * 10 }}%"></div>
                                </div>
                                <span class="mini-value">{{ entry.calmness }}/10</span>
                            </div>